## Титульный лист

Тема: Прогнозирование спроса в онлайн ритейле

Александр Сипко
Группа: AML-42
Руководитель: Даниил Корбут

+ [скачать презентацию PDF](./Сипко_Итоговая%20работа%20по%20программе%20Машинное%20обучение%20фундаментальные%20инструменты%20и%20практики.pdf)
+ [открыть решение в jupyter notebook](./28_final_task/predict.ipynb)

## Содержание

+ Введение и постановка задачи
+ Описание данных и их особенностей их подготовка для обучения моделей
+ Описание возможных решений и планируемая архитектура
+ Описание обучения
+ Заключение с выводами и планами на дальнейшее развитие (практическое применение)
+ Список литературы

## Введение и постановка задачи

Для бизнеса и онлайн-ритейла крайне важно эффективно управлять товарными
запасами и иметь инструменты, которые помогают принимать решения о количестве и
номенклатуре товаров, востребованных в ближайшее время. Это особенно актуально
в условиях жесткой конкуренции.

В рамках решения этой задачи я использовал методы машинного обучения,
включая кластеризацию на основе датасета, что позволило выявить группы товаров
с похожими характеристиками и продажами. Это дало возможность более точно
прогнозировать спрос. Я также разработал предиктивную модель продаж для каждой
категории товаров, что позволяет оптимизировать запасы и улучшить планирование.

Прогнозирование спроса — это ключевая задача для онлайн-ритейла, оказывающая
значительное влияние на управление запасами, логистику и планирование продаж.
Точные прогнозы позволяют снизить издержки, избежать дефицита товаров и
улучшить обслуживание клиентов, что дает компаниям конкурентное преимущество,
повышая эффективность операций и прибыль.

Стейкхолдеры:

+ Коммерческий директор – повышение прибыли.
+ Менеджеры по закупкам – минимизация издержек, планирование поставок.
+ Логистический отдел – сокращение затрат и управление запасами.
+ Маркетологи – планирование активностей и промо-компаний.
+ IT-отдел – поддержка инфраструктуры для сбора и обработки данных.
+ Финансовый отдел – бюджетирование и оценка рентабельности.

## Описание данных и их особенностей их подготовка для обучения моделей

В нашем распоряжении находятся данные о продажах в онлайн-ритейле за три года.
Данные не содержат разбивки по категориям и включают порядка 4000 уникальных
наименований. Каждая запись содержит метку даты и времени, а также информацию
о количестве продаж.
Ключевой особенностью этих данных является их максимальная приближенность к
реальным данным в бизнесе. Однако они плохо приспособлены для формирования
прогноза, так как отсутствует четкое выделение категорий товаров. Кроме того,
данные содержат пропуски и другие признаки некачественного ведения базы данных
торговых операций.

Также стоит отметить, что массив данных относительно короткий, что может
негативно сказаться на качестве предсказаний. Эти факторы требуют особого
внимания при разработке моделей прогнозирования, так как они могут влиять
на точность и надежность получаемых результатов.
Данный массив данных был выбран не случайно, так как имеется схожая бизнесовая
задача, однако, к сожалению, данные по причинам корпоративной безопасности
не могут быть представлены в целях данной дипломной работы.
Для работы с данными предварительно, массив был подготовлен:

+ проверены пропуски в данных
+ убраны пустые значения (замена на общее значение)
+ для целей кластеризации данных, были выбраны только уникальные наименования
  товаров
+ для целей предсказания временных рядов, данные были сгруппированы по
  категориям (кластерам) по недельным интервалам и суммой по количеству продаж.

## Описание возможных решений и планируемая архитектура

Можно выдвинуть несколько гипотез, которые описывают факторы влияющие
на продажи:

1. Гипотеза о предсказуемости трендов
Ожидается, что на основе исторических данных можно построить модели,
которые будут точно предсказывать будущие объемы продаж.
Это позволит более эффективно управлять запасами и планировать производство,
минимизируя издержки и оптимизируя процессы.

2. Гипотеза о сезонности продаж
Предполагается, что продажи определенных категорий товаров имеют выраженные
сезонные колебания. Это может быть выявлено при анализе данных по неделям и
годам, что позволит улучшить прогнозирование продаж в пиковые и низкие сезоны.

Но для проверки данных гипотез необходимо катетеризировать данные,
это можно сделать с помощью Кластеризация данных.
Это позволит выявить логически сгруппированные категории товаров и клиентов,
что, в свою очередь, поможет более точно анализировать поведение потребителей
и выявлять скрытые зависимости. Кластеризация также упростит процесс создания
предсказательных моделей, так как она может помочь в разделении данных на
однородные группы, что увеличит точность прогнозов.

Таким образом, применение кластеризации в рамках проведенного анализа станет
важным шагом к более глубокому пониманию динамики продаж и позволит создать
эффективные модели для их прогнозирования.

## Описание обучения

1. Кластеризация данных
   В данном проекте была проведена кластеризация текстовых данных с
   использованием различных моделей для извлечения эмбеддингов и оценки
   качества кластеризации с помощью нескольких метрик.

Для извлечения эмбеддингов текстов использовались следующие модели из библиотеки
SentenceTransformers:

paraphrase-MiniLM-L6-v2
all-MiniLM-L6-v2
bert-base-uncased
roberta-base
distilbert-base-uncased
Каждая из моделей была выбрана для тестирования, так как они обладают разными
архитектурами и могут по-разному представлять текстовые данные.

Процесс обучения
Извлечение эмбеддингов: Для каждой модели были извлечены эмбеддинги текстов
(в данном случае — описаний) с использованием метода encode.
Эмбеддинги были рассчитаны на доступном устройстве GPU.

Нормализация эмбеддингов:
Эмбеддинги были нормализованы с использованием
StandardScaler для устранения влияния различий в масштабе данных.

Снижение размерности:
Для визуализации и дальнейшего анализа эмбеддинги были преобразованы в
двумерное пространство с использованием алгоритма t-SNE.

Для оценки качества кластеризации были протестированы различные значения
k (количество кластеров) от 2 до 10 с использованием алгоритма KMeans:

Для каждого значения k выполнялась кластеризация эмбеддингов
с использованием KMeans, и для каждого кластера вычислялись следующие метрики:

Silhouette Score*:
Оценка качества кластеризации, показывающая,
насколько хорошо отдельные точки отделены от других кластеров.

Calinski-Harabasz Score:
Метрика, основанная на соотношении между межкластерной и внутрикластерной дисперсией.

Davies-Bouldin Score:
Метрика, основанная на сравнении расстояний между кластерами и их размерах.

Результаты
Для каждой модели и каждого значения k выводились результаты метрик.
Наилучшие результаты по Silhouette Score использовались для определения лучшей
модели, лучшего значения k, а также для получения кластеров и уменьшенных
эмбеддингов.

В результате был выбран лучший набор параметров, который может быть использован
для дальнейшего анализа и интерпретации данных.

*Silhouette Score — это метрика, используемая для оценки качества кластеризации.
Она измеряет, насколько хорошо каждый объект (данные) вписывается в свой
кластер по сравнению с другими кластерами. Значение Silhouette Score
варьируется от -1 до 1:

1: Объект хорошо кластеризован, находясь в правильном кластере, и далеко от
соседних кластеров.
0: Объект находится на границе между двумя кластерами, что делает его
неопределенным.
-1: Объект был неправильно классифицирован, так как ближе к другому кластеру.

2. Прогнозирование продаж, на основании данных
В данном проекте была проведена комплексная работа по анализу и прогнозированию
временных рядов с использованием различных моделей, включая Prophet, ARIMA и
экспоненциальное сглаживание.

Данные о продажах были загружены и преобразованы для анализа.

Дата из столбца InvoiceDate была конвертирована в формат datetime,
а уникальные категории товаров были выделены для дальнейшего анализа.

Реализована функция tsplot, которая позволяет визуализировать временной ряд,
а также автокорреляционную и частичную автокорреляционную функции,
что помогает оценить сезонность и тренды в данных.

Созданы функции для оценки различных моделей:
Prophet: используется для прогнозирования временных рядов с учетом сезонности.
ARIMA: применяется для анализа временных рядов с учетом авторегрессии и
скользящего среднего.
Экспоненциальное сглаживание: позволяет учитывать тренды и сезонность в данных.

Реализована базовая модель, использующая скользящее среднее, для сравнения
с более сложными моделями.

Для оценки устойчивости модели использован метод скользящего окна,
который разбивает данные на обучающую и тестовую выборки. (кросс-валидация)

Оптимизация параметров модели Prophet.
Проведена оптимизация параметров модели Prophet для выбора наилучших настроек,
таких как сезонность и ширина доверительного интервала.

Прогнозирование и визуализация результатов.
Для каждой категории товаров был построен прогноз с использованием лучших
параметров модели Prophet.
Результаты визуализированы с отображением исходных данных,
прогнозов и доверительных интервалов.

Сравнение моделей.
Для каждой категории были рассчитаны метрики качества (MSE, MAE, R²)
для различных моделей, что позволяет оценить их эффективность.

Все результаты были собраны в итоговую таблицу, включающую метрики для базовой
модели и модели Prophet, а также лучшие параметры для последующего анализа.
Этот подход позволяет получить более точные прогнозы продаж и выявить тренды
в данных, что может быть полезно для принятия бизнес-решений.

## Заключение с выводами и планами на дальнейшее развитие (практическое применение)

В результате выполненной работы по прогнозированию спроса в онлайн-ритейле были
достигнуты значительные результаты, подтверждающие изначально выдвинутые
гипотезы о предсказуемости трендов и сезонности продаж.

Подтверждение гипотез:
Оба предположения о наличии трендов и сезонных колебаний
в продажах нашли свое подтверждение. Это стало возможным благодаря тщательному
анализу данных и применению различных моделей прогнозирования, таких как
Prophet и ARIMA. Особенно четко проявилась сезонность в категориях товаров:

+ Праздничные украшения
+ Часы и рождественские украшения
+ Кухонные аксессуары и посуда
что позволяет делать уверенные прогнозы для этих сегментов.

Кластеризация данных:
В процессе работы была проведена кластеризация товаров,
что позволило выделить 10 логически обоснованных категорий. Это не только
упростило анализ, но и улучшило качество предсказаний, так как модели стали
работать с более однородными группами данных.

Практическое применение:
Полученные результаты и наработки уже используются непосредственно в реальном
бизнесе для оптимизации товарных запасов, планирования закупок и улучшения
логистики. Это, в свою очередь, способствует снижению издержек и повышению
уровня обслуживания клиентов.

Планы на будущее и фактическая ценность проделанной работы:
Данная работа станет основой для дальнейшего развития
инструмента стратегического планирования продаж. Важно продолжить улучшение
моделей, возможно, путем увеличения объема данных и использования более сложных
алгоритмов машинного обучения, что позволит повысить точность прогнозов и
адаптировать бизнес-процессы к изменяющимся условиям рынка. А так же
добавление в исходные данные такого признака как категория товаров.

Таким образом, проведенный анализ и разработанные модели не только подтвердили
теоретические предположения, но и предоставили практические инструменты для
улучшения бизнес-процессов в онлайн-ритейле.

## Список литературы

Hyndman, R.J., & Athanasopoulos, G. (2018). Forecasting: Principles and Practice. OTexts.
Box, G.E.P., Jenkins, G. M., & Reinsel, G. C. (2015). Time Series Analysis: Forecasting and Control. Wiley.
Taylor, S.J., & Letham, B. (2018). Forecasting at Scale. The American Statistician, 72(1), 37-45.
Shumway, R.H., & Stoffer, D. S. (2017). Time Series Analysis and Its Applications: With R Examples. Springer.
Prophet Documentation. (n.d.). Forecasting at Scale.
Chen, J., & Liu, L. (2020). A Review of Time Series Forecasting Methods. Journal of Statistics and Management Systems, 23(2), 245-260.
Kourentzes, N., & Petropoulos, F. (2020). Forecasting with Exponential Smoothing: A Review. International Journal of Forecasting, 36(1), 1-17.
Datta, A., & Khamis, M. (2021). Machine Learning for Time Series Forecasting. Journal of Business Research, 124, 1-12.
